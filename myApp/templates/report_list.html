{% extends 'admin/base_site.html' %}
{% load i18n admin_urls static admin_modify %}
{% cycle 'row1' 'row2' as row_colors %}

{% block extrahead %}
    {{ block.super }}
    <style>
        .column-reason{width: 20% !important;}
        .column-solved{width: 10% !important;}
    </style>
{% endblock %}

{% block content_title %}
    {{ title }} {% if site_header %} &raquo; {{ site_header|default:_('Django 管理') }} {% endif %}
{% endblock %}

{% block content %}
    <div class="module">
        <table>
            <thead>
                <tr>
                    <!-- <th scope="col">{% trans '   ' %}</th> -->
                    <th scope="col">{% trans 'Reported ID' %}</th>
                    <th scope="col">{% trans 'Reported Type' %}</th>
                    <th scope="col">{% trans 'Time' %}</th>
                    <th scope="col">{% trans 'User' %}</th>
                    <th scope="col" class="column-reason">{% trans 'Reason' %}</th>
                    <th scope="col" class="column-solved">{% trans 'Solved' %}</th>
                </tr>
            </thead>
            <tbody>
                {% for report in reports %}
                <tr class="{{row_colors }}">
                    <td>{{ report.RID }}</td>
                    <td>{% if report.Type == 0 %}Question{% else %}Answer{% endif %}</td>
                    <td>{{ report.RepTime }}</td>
                    <td>{{ report.UID.UserName }}</td>
                    <td>{{ report.Reason }}</td>
                    <td>
                        {% if report.isSolved %}
                            <span class="yes fa fa-check-circle"></span>
                        {% else %}
                            <a href="{% url 'solve_report' report.ID%}" class="no-link fa fa-times-circle"></a>
                            <a href="#" class="no-link solve-button fa fa-exclamation-triangle" data-report-id="{{ report.ID }}"></a>
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr><td colspan="7">{% trans "No reports available." %}</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}

{% block extra_js %}
    {{ block.super }}
    <script>
        $('.solve-button').click(function(event) {
            event.preventDefault();
            var reportId = $(this).data('report-id');
            window.location.href = "{% url 'solve_report' %}" + reportId;
        });
    </script>
{% endblock %}